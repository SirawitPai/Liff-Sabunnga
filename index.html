<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <title>LIFF Sabunnga</title>
    <link rel="stylesheet" href="css/style.css" media="all" />
  </head>
  <body class="bg">
    <img src="img/bg.jpg" alt="" width="100%" height="45%" />
    <div class="container">
      <div class="row">
        <div class="col s12 text-center">
          <h5>กรุณาเลือกหัวข้อในการแสดงรายการสินค้า</h5>
          <p>การคัดหัวข้อช่วยให้ง่ายต้องการหาสินค้าที่ท่านต้องการ</p>
        </div>
      </div>

      <div class="row">
        <label for="email" style="margin: 10px"
          >หัวข้อการคัดสินค้าดอกไม้:</label
        >
        <select
          class="form-control"
          id="topic"
          name="sellist1"
          style="margin: 10px"
          onchange="topictype()"
        >
          <option value="" disabled selected>กรุณาหัวข้อการคัดดอกไม้</option>
          <option value="รูปแบบการจัดดอกไม้">รูปแบบการจัดดอกไม้</option>
          <option value="สีของดอกไม้">สีของดอกไม้</option>
          <option value="ชนิดดอกไม้">ชนิดดอกไม้</option>
          <option value="ดอกไม้สำหรับวันสำคัญ">ดอกไม้สำหรับวันสำคัญ</option>
          <option value="สินค้าทั้งหมด">ทั้งหมด</option>
        </select>
        <select
          class="form-control"
          id="flowerarrangement"
          name="sellist2"
          style="display: none; margin: 10px"
          onchange="topictype()"
        >
          <option value="" disabled selected>รูปแบบการจัดดอกไม้</option>
          <option value="ช่อดอกไม้">ช่อดอกไม้</option>
          <option value="แจกัน">แจกัน</option>
          <option value="พวงหรีด">พวงหรีด</option>
          <option value="ทั้งหมด">ทั้งหมด</option>
        </select>

        <select
          class="form-control"
          id="flowercolor"
          name="sellist3"
          style="display: none; margin: 10px"
          onchange="topictype()"
        >
          <option value="" disabled selected>เลือกสีของดอกไม้</option>
          <option value="ดอกไม้สีขาว">ดอกไม้สีขาว</option>
          <option value="ดอกไม้สีชมพู">ดอกไม้สีชมพู</option>
          <option value="ดอกไม้สีเหลือง">ดอกไม้สีเหลือง</option>
          <option value="ดอกไม้สีแดง">ดอกไม้สีแดง</option>
          <option value="ดอกไม้สีม่วง">ดอกไม้สีม่วง</option>
          <option value="ทั้งหมด">ทั้งหมด</option>
        </select>

        <select
          class="form-control"
          id="bigday"
          name="sellist5"
          style="display: none; margin: 10px"
          onchange="topictype()"
        >
          <option value="" disabled selected>เลือกดอกไม้สำหรับวันสำคัญ</option>
          <option value="วันเกิด">วันเกิด</option>
          <option value="สำหรับขอโทษ">สำหรับขอโทษ</option>
          <option value="วันครบรอบ">วันครบรอบ</option>
          <option value="วาเลนไทน์">วาเลนไทน์</option>
          <option value="แสดงความยินดี">แสดงความยินดี</option>
          <option value="งานศพ">งานศพ</option>
          <option value="ทั้งหมด">ทั้งหมด</option>
        </select>

        <select
          class="form-control"
          id="bouquetsize"
          name="sellist6"
          style="display: none; margin: 10px"
          onchange="topictype()"
        >
          <option value="" disabled selected>ขนาดช่อดอกไม้</option>
          <option value="ช่อขนาดเล็ก">ช่อขนาดเล็ก</option>
          <option value="ช่อขนาดกลาง">ช่อขนาดกลาง</option>
          <option value="ช่อขนาดใหญ่">ช่อขนาดใหญ่</option>
          <option value="ทั้งหมด">ทั้งหมด</option>
        </select>

        <select
          class="form-control"
          id="flowers"
          name="sellist6"
          style="display: none; margin: 10px"
          onchange="topictype()"
        >
          <option value="" disabled selected>เลือกชนิดดอกไม้</option>
          <option value="ดอกกุหลาบ">ดอกกุหลาบ</option>
          <option value="ดอกทานตะวัน">ดอกทานตะวัน</option>
          <option value="ดอกยิปโซ">ดอกยิปโซ</option>
          <option value="ดอกทิวลิป">ดอกทิวลิป</option>
          <option value="ดอกคาร์เนชั่น">ดอกคาร์เนชั่น</option>
          <option value="ทั้งหมด">ทั้งหมด</option>
        </select>
        <br />
        <button id="btnShareflower" onclick="sendMsg()">
          คลิกส่งข้อมูลสินค้า
        </button>
        <br />
        <button id="btnShare" onclick="shareMsg()">แนะนำบอทให้เพื่อน</button>
        <br />
        <button id="btnClose" onclick="Closed()">Close</button>
      </div>

      <br />
      <div id="footer" class="center-align text-center">
        <p>
          ร้านดอกไม้สบันงานยินดีให้บริการ
          <br />
          โทร. 02-9185839
        </p>
      </div>
    </div>

    <!-- <script src="js/vconsole.min.js"></script>
    <script>
      var vConsole = new VConsole();
      console.log("Hello World!");
    </script> -->

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

    <script>
      var keyword = "";

      async function topictype() {
        const topice = document.getElementById("topic").value;
        if (topice == "รูปแบบการจัดดอกไม้") {
          document.getElementById("flowerarrangement").style.display = "block";

          document.getElementById("flowercolor").style.display = "none";
          document.getElementById("bigday").style.display = "none";
          var flowerarrangement =
            document.getElementById("flowerarrangement").value;

          if (flowerarrangement == "ช่อดอกไม้") {
            document.getElementById("bouquetsize").style.display = "block";
            var bouquetsize = document.getElementById("bouquetsize").value;

            if (bouquetsize  == "ช่อขนาดเล็ก") {
              keyword = "ช่อขนาดเล็ก";
            } else  if (bouquetsize  == "ช่อขนาดกลาง") {
              keyword = "ช่อขนาดกลาง";
            }else  if (bouquetsize  == "ช่อขนาดใหญ่") {
              keyword = "ช่อขนาดใหญ่";
            }else{
              keyword = "ช่อดอกไม้ทั้งหมด";
            }
          } else if (flowerarrangement == "แจกัน") {
            keyword = "แจกัน";
            document.getElementById("bouquetsize").style.display = "none";
          } else if (flowerarrangement == "พวงหรีด") {
            keyword = "พวงหรีด";
            document.getElementById("bouquetsize").style.display = "none";
          } else {
            keyword = "รูปแบบการจัดทั้งหมด";
            document.getElementById("bouquetsize").style.display = "none";
          }

        } else if (topice == "สีของดอกไม้") {
          document.getElementById("flowercolor").style.display = "block";
          var flowercolor = document.getElementById("flowercolor").value;
          if(flowercolor == "ดอกไม้สีขาว"){
             keyword = "ดอกไม้สีขาว";
          } else if(flowercolor == "ดอกไม้สีชมพู"){
            keyword = "ดอกไม้สีชมพู";
          }else if(flowercolor == "ดอกไม้สีเหลือง"){
            keyword = "ดอกไม้สีเหลือง";
          }else if(flowercolor == "ดอกไม้สีแดง"){
            keyword = "ดอกไม้สีแดง";
          }else if(flowercolor == "ดอกไม้สีม่วง"){
            keyword = "ดอกไม้สีม่วง";
          }else {
            keyword = "สีดอกไม้ทั้งหมด";
          }
          document.getElementById("flowerarrangement").style.display = "none";
          document.getElementById("bigday").style.display = "none";
          document.getElementById("bouquetsize").style.display = "none";
          document.getElementById("flowers").style.display = "none";

        } else if (topice == "ชนิดดอกไม้") {
          document.getElementById("flowers").style.display = "block";
          var flowers = document.getElementById("flowers").value;
          if(flowers == "ดอกกุหลาบ"){
             keyword = "ดอกกุหลาบ";
          }else if(flowers == "ดอกทานตะวัน"){
            keyword = "ดอกทานตะวัน";
          }else if(flowers == "ดอกยิปโซ"){
            keyword = "ดอกยิปโซ";
          }else if(flowers == "ดอกทิวลิป"){
            keyword = "ดอกทิวลิป";
          }else if(flowers == "ดอกคาร์เนชั่น"){
            keyword = "ดอกคาร์เนชั่น";
          }else {
            keyword = "ดอกไม้ทั้งหมด";
          }

          document.getElementById("flowerarrangement").style.display = "none";
          document.getElementById("flowercolor").style.display = "none";
          document.getElementById("bigday").style.display = "none";
          document.getElementById("bouquetsize").style.display = "none";
        } else if (topice == "ดอกไม้สำหรับวันสำคัญ") {
          document.getElementById("bigday").style.display = "block";
          var bigday = document.getElementById("bigday").value;
          if(bigday == "วันเกิด"){
             keyword = "วันเกิด";
          }else if(bigday == "สำหรับขอโทษ"){
            keyword = "สำหรับขอโทษ";
          }else if(bigday == "วันครบรอบ"){
            keyword = "วันครบรอบ";
          }else if(bigday == "วาเลนไทน์"){
            keyword = "วาเลนไทน์";
          }else if(bigday == "แสดงความยินดี"){
            keyword = "แสดงความยินดี";
          }else if(bigday == "งานศพ"){
            keyword = "งานศพ";
          }else {
            keyword = "วันทั้งหมด";
          }

          document.getElementById("flowerarrangement").style.display = "none";
          document.getElementById("flowercolor").style.display = "none";
          document.getElementById("bouquetsize").style.display = "none";
          document.getElementById("flowers").style.display = "none";
        } else {
          document.getElementById("flowerarrangement").style.display = "none";
          document.getElementById("flowercolor").style.display = "none";
          document.getElementById("bigday").style.display = "none";
          document.getElementById("bouquetsize").style.display = "none";
          document.getElementById("flowers").style.display = "none";
          keyword = "สินค้าทั้งหมด";
        }
      }

      async function shareMsg() {
        await liff.shareTargetPicker([
          {
            type: "text",
            text: "สวัสดีค่ะ ร้านดอกไม้สบันงายินดีให้บริการ",
          },
        ]);
        liff.closeWindow();
      }

      function Closed() {
        liff.closeWindow();
      }

      async function getFriendship() {
        const friend = await liff.getFriendship();
        document.getElementById("friendship").append(friend.friendFlag);
        if (!friend.friendFlag) {
          if (confirm("คุณยังไม่ได้เพิ่ม Bot เป็นเพื่อน จะเพิ่มเลยไหม ?")) {
            window.location = "https://line.me/R/ti/p/Q178yfyoa";
          }
        }
      }

      async function sendMsg() {
        if(keyword== ""){
          alert("กรุณาเลือกหัวข้อในการแสดงสินค้าก่อน");
        }
        else{
           if (
          liff.getContext().type !== "none" &&
          liff.getContext().type !== "external"
        ) {
          await liff.sendMessages([
            {
              type: "text",
              text: keyword,
            },
          ]);
          // alert("Message Sent");
        }
        liff.closeWindow();
        }
      }
      async function main() {
        liff.ready.then(() => {
          document.getElementById("isLoggedIn").append(liff.isLoggedIn());
          if (liff.isLoggedIn()) {
            getFriendship();
          } else {
            liff.login();
          }
        });
        await liff.init({ liffId: "1656033600-Bwm23aQn" });
      }
      main();
    </script>
  </body>
</html>
